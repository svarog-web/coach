function getarraysize(e){for(i=0;i<e.length;i++){if(e[i]=="undefined"||e[i]==""||e[i]==null)return i}return e.length}function arraypush(e,t){e[getarraysize(e)]=t}function arraypop(e){thearraysize=getarraysize(e);retval=e[thearraysize-1];delete e[thearraysize-1];return retval}function bbstyle(myform,bbnumber){var txtarea=myform.profilebookpostercomments;id=myform.getAttribute("id");var bbcode=eval("_"+id+"_bbcodestack");txtarea.focus();donotinsert=false;theSelection=false;bblast=0;if(bbnumber==-1){while(bbcode[0]){butnumber=arraypop(bbcode)-1;txtarea.value+=bbtags[butnumber+1];buttn=eval("myform.addbbcode"+butnumber);buttn.value=buttn.value.substr(1,buttn.value.length-1)}imageTag=false;txtarea.focus();return}if(clientVer>=4&&is_ie&&is_win){theSelection=document.selection.createRange().text;if(theSelection){document.selection.createRange().text=bbtags[bbnumber]+theSelection+bbtags[bbnumber+1];txtarea.focus();theSelection="";return}}else if(txtarea.selectionEnd&&txtarea.selectionEnd-txtarea.selectionStart>0){mozWrap(txtarea,bbtags[bbnumber],bbtags[bbnumber+1]);return}for(i=0;i<bbcode.length;i++){if(bbcode[i]==bbnumber+1){bblast=i;donotinsert=true}}if(donotinsert){while(bbcode[bblast]){butnumber=arraypop(bbcode)-1;insertAtCaret(txtarea,bbtags[butnumber+1]);buttn=eval("myform.addbbcode"+butnumber);buttn.value=buttn.value.substr(1,buttn.value.length-1);imageTag=false}txtarea.focus();return}else{if(imageTag&&bbnumber!=14){insertAtCaret(txtarea,bbtags[15]);lastValue=arraypop(bbcode)-1;myform.addbbcode14.value="Img";imageTag=false}insertAtCaret(txtarea,bbtags[bbnumber]);if(bbnumber==14&&imageTag==false)imageTag=true;arraypush(bbcode,bbnumber+1);buttn=eval("myform.addbbcode"+bbnumber);buttn.value="/"+buttn.value;txtarea.focus();return}}function mozWrap(e,t,n){var r=e.textLength;var i=e.selectionStart;var s=e.selectionEnd;if(s==1||s==2){s=r}var o=e.scrollTop;var u=e.value.substring(0,i);var a=e.value.substring(i,s);var f=e.value.substring(s,r);e.value=u+t+a+n+f;if(e.setSelectionRange){if(a.length==0){e.setSelectionRange(i+t.length,i+t.length)}else{e.setSelectionRange(i,i+t.length+a.length+n.length)}e.focus()}e.scrollTop=o;return}function insertAtCaret(e,t){if(typeof e.caretPos!="undefined"&&e.createTextRange){var n=e.caretPos;n.text=n.text.charAt(n.text.length-1)==" "?t+" ":t;n.select()}else if(typeof e.selectionStart!="undefined"){var r=e.value.substr(0,e.selectionStart);var i=e.value.substr(e.selectionEnd);var s=e.scrollTop;e.value=r+t+i;if(e.setSelectionRange){e.focus();e.setSelectionRange(r.length+t.length,r.length+t.length)}e.scrollTop=s}else{e.value+=t;e.focus(e.value.length-1)}}function setCaretToEnd(e){if(e.createTextRange){var t=e.createTextRange();t.collapse(false);t.select()}else if(e.setSelectionRange){e.focus();var n=e.value.length;e.setSelectionRange(n,n)}}function setCursorPosition(e,t,n){if(e.setSelectionRange){e.setSelectionRange(t,n)}else if(e.createTextRange){var r=e.createTextRange();r.collapse(true);r.moveEnd("character",n);r.moveStart("character",t);r.select()}}function bbfontstyle(e,t,n){if(typeof e.caretPos!="undefined"&&e.createTextRange){var r=e.caretPos;var i=r.text.length;r.text=r.text.charAt(r.text.length-1)==" "?t+r.text+n+" ":t+r.text+n;if(i==0){r.moveStart("character",-n.length);r.moveEnd("character",-n.length);r.select()}else{e.focus(r)}}else if(clientVer>=4&&is_ie&&is_win){theSelection=document.selection.createRange().text;if(!theSelection){e.value+=t+n;e.focus();return}document.selection.createRange().text=t+theSelection+n;e.focus();return}else if(typeof e.selectionStart!="undefined"){mozWrap(e,t,n)}else{e.focus();insertAtCaret(e,t+n)}}function textCounter(e,t,n){if(e.value.length>n){e.value=e.value.substring(0,n)}else{t.value=n-e.value.length}}function pb_emo(e,t){if(typeof e.caretPos!="undefined"&&e.createTextRange){t=" "+t+" "}else if(typeof e.selectionStart!="undefined"){if(e.selectionStart>0){charbefore=e.value.substr(e.selectionStart-1,1);if(charbefore!=" "&&charbefore!="\n"){t=" "+t}}if(e.selectionEnd<e.value.length){charafter=e.value.substr(e.selectionEnd,1);if(charafter!=" "&&charafter!="\n"){t+=" "}}}else{t=" "+t+" "}e.focus();insertAtCaret(e,t)}function pb_submitForm(mfrm){var me=mfrm.elements;var rChecked;var submitme=1;me["submitentry"].disabled=true;me["profilebookpostercomments"].readOnly=true;var errorMSG="";var confirmMSGs=Array();var id=mfrm.getAttribute("id");validationArray=eval("_"+id+"_validations");for(var j=0;j<validationArray.length;j++){var i=validationArray[j][0];if(typeof me[i].type=="undefined"){e:for(var ii=0;ii<me.length;ii++){if(i==me[ii].getAttribute("name")){if(me[ii].type=="radio"||me[ii].type=="checkbox"){var rOptions=me[me[ii].getAttribute("name")];rChecked=0;if(rOptions.length>1){for(var r=0;r<rOptions.length;r++){if(rOptions[r].checked){rChecked=1;break e}}break e}else{if(me[ii].checked){rChecked=1;break e}}}}}}if(typeof me[i].type=="undefined"&&rChecked==0||me[i].value==""){if(validationArray[j][1]){confirmMSGs.push(validationArray[j][1])}else{errorMSG+=validationArray[j][2]+"\n";submitme=0}}}if(errorMSG!=""){alert(errorMSG)}else{for(var j=0;j<confirmMSGs.length;j++){if(!confirm(confirmMSGs[j])){submitme=0;break}}}if(submitme>0){return true}else{me["submitentry"].disabled=false;me["profilebookpostercomments"].readOnly=false;return false}}var imageTag=false;var theSelection=false;var clientPC=navigator.userAgent.toLowerCase();var clientVer=parseInt(navigator.appVersion);var is_ie=clientPC.indexOf("msie")!=-1&&clientPC.indexOf("opera")==-1;var is_nav=clientPC.indexOf("mozilla")!=-1&&clientPC.indexOf("spoofer")==-1&&clientPC.indexOf("compatible")==-1&&clientPC.indexOf("opera")==-1&&clientPC.indexOf("webtv")==-1&&clientPC.indexOf("hotjava")==-1;var is_moz=0;var is_win=clientPC.indexOf("win")!=-1||clientPC.indexOf("16bit")!=-1;var is_mac=clientPC.indexOf("mac")!=-1;bbtags=new Array("[b]","[/b]","[i]","[/i]","[u]","[/u]","[quote]","[/quote]","[code]","[/code]","[ul]","[/ul]","[ol]","[/ol]","[img]","[/img]","[url=http://www.example.com]","[/url]","[li]","[/li]");(function(e){e.fn.cbpbtoggleEditor=function(t){this.each(function(){var t=e("#"+e(this).attr("rel"));if(e(this).hasClass("cbpbEditorShow")){e(this).addClass("cbpbEditorVisible");t.show().find("textarea.cbpbEditor").trigger("autosize.resize")}else{e(this).addClass("cbpbEditorHidden");t.hide()}e(this).click(function(){var t=null;if(e(this).hasClass("cbpbEditorHidden")){if(e(this).attr("title")&&!confirm(e(this).attr("title"))){return}e(this).removeClass("cbpbEditorHidden").addClass("cbpbEditorVisible");t=function(){e(this).find("textarea.cbpbEditor").trigger("autosize.resize")}}else{e(this).removeClass("cbpbEditorVisible").addClass("cbpbEditorHidden")}e("#"+e(this).attr("rel")).slideToggle("slow",t);return false})});return this};e.fn.cbpbControlsHover=function(t){this.each(function(){e(this).children(t).fadeTo(0,.001);e(this).hover(function(){e(this).children(t).fadeTo(0,1)},function(){e(this).children(t).fadeTo("slow",.001)})});return this}})(jQuery);jQuery(document).ready(function(e){e("textarea.cbpbEditor").autosize();e("a.cbpbToggleEditor").cbpbtoggleEditor();e(".cbpbSnglMsgAll").cbpbControlsHover(".cbpbControlArea")});
